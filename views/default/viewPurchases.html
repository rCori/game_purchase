{{extend 'layout.html'}}

<select id="storedrop">
  <option value="All"> </option>
  <option value="GameStop">GameStop</option>
  <option value="Amazon">Amazon</option>
  <option value="Best Buy">Best Buy</option>
  <option value="Target">Target</option>
  <option value="Wal-Mart">Wal-Mart</option>
  <option value="Toys \'R Us">Toys 'R Us</option>
  <option value="Ebay">Ebay</option>
  <option value="Craigslist">Craigslist</option>
  <option value="FuncoLand">FuncoLand</option>
  <option value="EB Games">EB Games</option>
  <option value="GAME">GAME</option>
  <option value="other">other</option>
</select>
<input type="image" id="sort" src="{{=URL('static','images/sortbutton.jpg')}}">

<div id="toplogo" style="max-width:499px;">
    <img src="{{=URL('static','images/smalllogo.png')}}">
</div>

<link rel="stylesheet" type="text/css" href="{{=URL('static','css/viewPurchasesLayout.css')}}">

<table id="purchaseTable" border="0">
{{for row in rows:}}
	<tr>
		<td>
            <a href="{{=URL('default','viewSingle',args=row.id)}}">{{=row.title}}</a>
		</td>
		<td style="vertical-align:middle;">
            <span style="font-family:Arial; font-weight:900;">{{=row.description}} at {{=row.store}} in {{=row.store_loc}} for ${{="{0:0.2f}".format(row.price)}}</span>
			<br>
			<span style="font-family:Arial; font-weight:900;">bought by {{=row.user_ref.email}} on {{=row.time_submitted}}</span>
		</td>
		<td>
            <span style="font-family:Arial; font-weight:900;">{{=row.average_score}}/10</span>
		</td>
	</tr>
{{pass}}
</table>
{{if page!=0:}}
<input type="image" id ="Previous" src="{{=URL('static','images/previousbutton.jpg')}}">
{{pass}}
<input type="image" id="Next" src="{{=URL('static','images/nextbutton.jpg')}}">



<script>
    /*
    $("#sort").click(function(){
        $.get("{{#=URL('default','sortPurchase')}}",
            {store:$("#storedrop").val()})
            .success(function(data){
                console.log(data);
            });
    });
    */
	var curPage = {{=page}};
    //This is a hack to get this to work quickly
    $("#sort").click(function(){
        var newStore = $("#storedrop").val()
        window.location.href = "{{=URL('default','viewPurchases')}}?store="+newStore;
    });
	
	$("#Previous").click(function(){
		var newPage = curPage-1;
		window.location.href = "{{=URL('default','viewPurchases')}}?pgnum="+newPage;
	});
	
	$("#Next").click(function(){
		var newPage = curPage+1;
		window.location.href = "{{=URL('default','viewPurchases')}}?pgnum="+newPage;
	});
</script>
